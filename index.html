<!DOCTYPE html>
<html lang="en">
<head>
    <title>Network</title>
    <script
            type="text/javascript"
            src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"
    ></script>
    <style type="text/css">
        #mynetwork {
          width: 600px;
          height: 400px;
          border: 1px solid lightgray;
        }
    </style>
</head>
<body>
<div id="mynetwork"></div>
<div id="description"></div>
<script type="text/javascript">


    var nodes = [];
    var edges = [];
    var ids = [];

    fetch('all_nodes.json')
    .then(response => response.json())
    .then(data => {
        const filesList = data.files;
        const fetchPromises = filesList.map(fileName => {
            return fetch(fileName)
            .then(response => response.json())
            .then(fileData => {
                if (!Array.isArray(nodes)) {
                    nodes = [];
                }
                if (!Array.isArray(edges)) {
                    edges = [];
                }
                if (!Array.isArray(ids)) {
                    ids = [];
                }
                nodes.push({id: fileData.id, label: fileData.label});
                ids.push(fileData.id);
                for (let edge_data of fileData.edge_to) {
                    edges.push({from: fileData.id, to: edge_data});
                }
            });
        });
        return Promise.all(fetchPromises);
    })
    .then(() => {
        var container = document.getElementById("mynetwork");
        var data = {
          nodes: new vis.DataSet(nodes),
          edges: new vis.DataSet(edges),
        };
        var description_container = document.getElementById("description");
        var options = {};
        var network = new vis.Network(container, data, options);

        network.on("click", function(clickProperties) {
            if(clickProperties.nodes.length == 1) {
                var id = ids.indexOf(clickProperties.nodes[0]);

                description_container.style.display = "block";
                description_container.textContent = nodes[id].label;
            } else if(clickProperties.nodes.length == 0) {
                description_container.style.display = 'none';
            }
        });
    });
</script>
</body>
</html>